{% extends 'Frontend/repeater.html' %}
{% load static %}
{% block content %}
	  <style type="text/css">
    .ratings {
      float: left;
    }

    .ratings:not(:checked)>input {
      position: absolute;
      top: -9999px;
      clip: rect(0, 0, 0, 0);
    }

    .ratings:not(:checked)>label {
      float: right;
      width: 1em;
      padding: 0 .1em;
      overflow: hidden;
      white-space: nowrap;
      cursor: pointer;
      font-size: 200%;
      line-height: 1.2;
      color: #ddd;
      text-shadow: 1px 1px #bbb, 2px 2px #666, .1em .1em .2em rgba(0, 0, 0, .5);
    }

    .ratings:not(:checked)>label:before {
      content: '★ ';
    }

    .ratings>input:checked~label {
      color: #f70;
      text-shadow: 1px 1px #c60, 2px 2px #940, .1em .1em .2em rgba(0, 0, 0, .5);
    }

    .ratings:not(:checked)>label:hover,
    .ratings:not(:checked)>label:hover~label {
      color: gold;
      text-shadow: 1px 1px goldenrod, 2px 2px #B57340, .1em .1em .2em rgba(0, 0, 0, .5);
    }

    .ratings>input:checked+label:hover,
    .ratings>input:checked+label:hover~label,
    .ratings>input:checked~label:hover,
    .ratings>input:checked~label:hover~label,
    .ratings>label:hover~input:checked~label {
      color: #ea0;
      text-shadow: 1px 1px goldenrod, 2px 2px #B57340, .1em .1em .2em rgba(0, 0, 0, .5);
    }

    .ratings>label:active {
      position: relative;
      top: 2px;
      left: 2px;
    }

    /* end of Lea's code */

    /*
 * Clearfix from html5 boilerplate
 */

    .clearfix:before,
    .clearfix:after {
      content: " ";
      /* 1 */
      display: table;
      /* 2 */
    }

    .clearfix:after {
      clear: both;
    }

    /*
 * For IE 6/7 only
 * Include this rule to trigger hasLayout and contain floats.
 */

    .clearfix {
      *zoom: 1;
    }

    /* my stuff */
    #status,
    button {
      margin: 20px 0;
    }
  </style>
<style>
        /* Always set the map height explicitly to define the size of the div
         * element that contains the map. */
        #map1 {
            height: 400px;
            width: 100%;
        }

        /* Optional: Makes the sample page fill the window. */
        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>








	<!--main-->
	<main class="main">		
		<div class="wrap">
		
			<!--breadcrumbs-->
			<nav class="breadcrumbs">
				<!--crumbs-->
				<ul>
					<li><a href="#" title="Home">Home</a></li>
					<li><a href="#" title="Travel guides">Travel guides</a></li>
					<li>{{p.Des_Name}}</li>
				</ul>
				<!--//crumbs-->
			</nav>
			<!--//breadcrumbs-->
			
			<div class="row">
				<!--three-fourth content-->
				<section class="three-fourth">
				
					<h1>{{p.Des_Name}}</h1>
					
					<!--inner navigation-->
					<nav class="inner-nav">
						<ul>
							<li><a href="#general_info" title="General information">General information</a></li>
                            <li><a href="#Route" title="Google Route">Google Route </a></li>
							<li><a href="#culture" title="Culture and history">Culture and history</a></li>
							<li><a href="#hotels" title="Hotels">Trips</a></li>
							<li><a href="#reviews" title="Reviews">Reviews</a></li>
						</ul>
					</nav>
					<!--//inner navigation-->
					
					<!--General information-->
					<section id="general_info" class="tab-content">
						<article>
							<h2>{{p.Des_Name}}</h2>
							<figure><img src="{{p.pic.url}}" alt=" " /></figure>
							<p><strong>{{p.Des_Description1}} </strong></p>
							<table>
								<tr>
									<th>Sovereign state</th>
									<td>{{p.state}}</td>
								</tr>
								<tr>
									<th>Country</th>
									<td>Pakistan</td>
								</tr>
								<tr>
									<th>Area</th>
									<td>{{p.Area}}</td>
								</tr>
								<tr>
									<th>Time zone</th>
									<td>GMT</td>
								</tr>
								<tr>
									<th>Languages spoken</th>
									<td>{{p.Languages}}</td>
								</tr>
								<tr>
									<th>Currency</th>
									<td>PKR</td>
								</tr>
								<tr>
									<th>Visa requirements</th>
									<td>No Visa needed</td>
								</tr>
							</table>
						</article>
					</section>
					<!--//General information-->

						<!--Culture and history-->
					<section id="Route" class="tab-content">
                        <article>
                        <div id="map1"></div>
                            <div></div>
                            <div id="table1">
                            <h2>Route 1 (best for time saving)</h2>
                        <table>
								<tr>
									<th>Distance</th>
									<td id="dist1"></td>
								</tr>
								<tr>
									<th>Time Duration</th>
									<td id="time1"></td>
								</tr>
								<tr>
									<th>Way</th>
									<td id="summery1"></td>
								</tr>
								<tr>
									<th>StartingPoint</th>
									<td id="start1"></td>
								</tr>
								<tr>
									<th>Ending Point</th>
									<td id="end1"></td>
								</tr>
							</table>
                            </div>

                            <div id="table2">
                            <h2>Route 2</h2>
                            <table >
								<tr>
									<th>Distance</th>
									<td id="dist2"></td>
								</tr>
								<tr>
									<th>Time Duration</th>
									<td id="time2"></td>
								</tr>
								<tr>
									<th>Way</th>
									<td id="summery2"></td>
								</tr>
								<tr>
									<th>StartingPoint</th>
									<td id="start2"></td>
								</tr>
								<tr>
									<th>Ending Point</th>
									<td id="end2"></td>
								</tr>
							</table>
                            </div>

                            <div id="table3">
                            <h2>Route 3</h2>
                            <table>
								<tr>
									<th>Distance</th>
									<td id="dist3"></td>
								</tr>
								<tr>
									<th>Time Duration</th>
									<td id="time3"></td>
								</tr>
								<tr>
									<th>Way</th>
									<td id="summery3"></td>
								</tr>
								<tr>
									<th>StartingPoint</th>
									<td id="start3"></td>
								</tr>
								<tr>
									<th>Ending Point</th>
									<td id="end3"></td>
								</tr>
							</table>
                            </div>
                        </article>
					</section>
					
					
					<!--Culture and history-->
					<section id="culture" class="tab-content">
						<article>
							<h2>Culture and history</h2>
							<figure><img src="{{p.pic.url}}" alt="Things to do " /></figure>
							<p><strong>{{ p.history3 }}</strong></p>
							<p>{{ p.history1 }}</p>
							 <p>{{ p.history2 }}</p>
						</article>
					</section>
					<!--//Culture and history-->
					
					<!--Hotels-->
					<section id="hotels" class="tab-content">
						<div class="deals row">
							<!--deal-->
                            {% for trip in trips %}
							<article class="full-width">
								<figure><a href="Trip/{{trip.Trip_Id}}" title=""><img src="{{trip.pic.url}}" alt="" /></a></figure>
								<div class="details">
									<h3>{{ trip.T_Name }}
										<span class="stars">
											<i class="material-icons">&#xE838;</i>
											<i class="material-icons">&#xE838;</i>
											<i class="material-icons">&#xE838;</i>
											<i class="material-icons">&#xE838;</i>
										</span>
									</h3>
									<span class="address">{{trip.startLocation}}  •  <a href="#">Show on map</a></span>
									<span class="rating"> 8 /10</span>
									<span class="price">  <em> Rs. {{ trip.price }}</em> </span>
									<div class="description">
										<p> {{ trip.noOfDays }} Days / {{ trip.noOfNights }} Nights</p>
									</div>
									<a href="#" title="Book now" class="gradient-button">Book now</a>
								</div>
							</article>
							{% endfor %}
							<!--bottom navigation-->
							<div class="bottom-nav full-width">
								<!--back up button-->
								<a href="#" class="scroll-to-top" title="Back up">Back up</a> 
								<!--//back up button-->
								
								<!--pager-->
								<div class="pager">
									<span><a href="#">First page</a></span>
									<span><a href="#">&lt;</a></span>
									<span class="current">1</span>
									<span><a href="#">2</a></span>
									<span><a href="#">3</a></span>
									<span><a href="#">4</a></span>
									<span><a href="#">5</a></span>
									<span><a href="#">&gt;</a></span>
									<span><a href="#">Last page</a></span>
								</div>
								<!--//pager-->
							</div>
							<!--//bottom navigation-->
						</div>
					</section>
					<!--//Hotels-->				
					
					
					<!--reviews-->
					<section id="reviews" class="tab-content">

                         <article id="mytable1">
							<h2>Destination Score and Score Breakdown</h2>
							<div class="score">
								<span class="achieved">{{ p.Average_Rating }} </span>
								<span> / 5</span>
								<p class="info">Based on <label id="reviewcount"></label> {{ p.Total_Reviews }} reviews</p>
								<p class="disclaimer">Reviews are written by our customers after their trip at <strong>{{p.Des_Name}}.</strong></p>
							</div>

						</article>

						
						<article>
							<h2>Reviews</h2>
							<ul class="reviews">
								<!--review-->
                            <div id="mytable">
                                {% for rev in revs %}
								<li>
									<figure class="left">
										<img src="{% static 'Frontend/images/uploads/avatar.jpg' %}" alt="avatar" />
										<address><span>{{rev.reviewBy}}</span><br /><br />{{rev.created_at}}</address>
									</figure>
									<div class="rev "><p>{{rev.rev_good}}
                                    <span class="stars">
                                           {% if rev.rating == 0 %}
                                             <i class="material-icons">&#xe83a;</i>
                                             <i class="material-icons">&#xe83a;</i>
                                             <i class="material-icons">&#xe83a;</i>
                                             <i class="material-icons">&#xe83a;</i>
                                             <i class="material-icons">&#xe83a;</i>
                                        {% elif rev.rating == 1 %}
                                             <i class="material-icons">&#xE838;</i>
                                             <i class="material-icons">&#xe83a;</i>
                                             <i class="material-icons">&#xe83a;</i>
                                             <i class="material-icons">&#xe83a;</i>
                                             <i class="material-icons">&#xe83a;</i>
                                        {% elif rev.rating == 2 %}
                                            <i class="material-icons">&#xE838;</i>
                                            <i class="material-icons">&#xE838;</i>
                                            <i class="material-icons">&#xe83a;</i>
                                            <i class="material-icons">&#xe83a;</i>
                                            <i class="material-icons">&#xe83a;</i>
                                        {% elif rev.rating == 3 %}
                                            <i class="material-icons">&#xE838;</i>
                                            <i class="material-icons">&#xE838;</i>
                                            <i class="material-icons">&#xE838;</i>
                                            <i class="material-icons">&#xe83a;</i>
                                            <i class="material-icons">&#xe83a;</i>
                                        {% elif drev.rating == 4 %}
                                            <i class="material-icons">&#xE838;</i>
                                            <i class="material-icons">&#xE838;</i>
                                            <i class="material-icons">&#xE838;</i>
                                            <i class="material-icons">&#xE838;</i>
                                            <i class="material-icons">&#xe83a;</i>
                                        {% elif rev.rating == 5 %}
                                            <i class="material-icons">&#xE838;</i>
                                            <i class="material-icons">&#xE838;</i>
                                            <i class="material-icons">&#xE838;</i>
                                            <i class="material-icons">&#xE838;</i>
                                            <i class="material-icons">&#xE838;</i>
                                        {% else %}
                                              <i class="material-icons">&#xe83a;</i>
                                             <i class="material-icons">&#xe83a;</i>
                                             <i class="material-icons">&#xe83a;</i>
                                             <i class="material-icons">&#xe83a;</i>
                                             <i class="material-icons">&#xe83a;</i>
                                        {% endif %}
                                     </span></p>
                                    </div>
									</li>
								<!--//review-->
								{% endfor %}
                            </div>

								<!--review-->
								<li >
                                    {% if username is not None %}
                                    <figure class="left">
										<img src="{% static 'Frontend/images/uploads/avatar.jpg' %}" alt="avatar" />
										<address><span>{{username}}</span><br /><br /></address>
									</figure>
                                        <div class="rev ">
							        <input  id="reviewww" required style="border: black 1px dotted " name=" " placeholder="Place your Review" />
                                        <div id="ratingsForm">
                                        <fieldset class="ratings">
                                        <input type="radio" hidden id="star5" name="ratings" value="5" /><label for="star5" title="Rocks!">5 stars</label>
                                        <input type="radio" hidden id="star4" name="ratings" value="4" /><label for="star4" title="Pretty good">4 stars</label>
                                        <input type="radio" hidden id="star3" name="ratings" value="3" /><label for="star3" title="Meh">3 stars</label>
                                        <input type="radio" hidden id="star2" name="ratings" value="2" /><label for="star2" title="Kinda bad">2 stars</label>
                                        <input type="radio" hidden id="star1" name="ratings" value="1" /><label for="star1" title="Sucks big time">1 star</label>
                                        </fieldset>
                                        <div class="clearfix"></div>
                                        </div>

                                    <input type="submit" id="buttonc" onclick="Myfuni({{ p.Des_Id }})" value="Submit" class="gradient-button" />
                                    <label id="label11"></label>
                                        </div>
                                    {% else %}
                                    <label> Please login for add review</label>
                                    {% endif %}
                                </li>
								<!--//review-->

							</ul>
						</article>
					</section>
					<!--//reviews-->
					   <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
					 <script>


                         var rating=0;
                         $(document).ready(function () {

                            });


                        function Myfuni(hhhh) {
                            var content=document.getElementById("reviewww").value;
                            document.getElementById("label11").innerHTML="wait"
                                if ($("#ratingsForm :radio:checked").length == 0) {
                                  rating=0;
                                } else {
                                  rating= $('input:radio[name=ratings]:checked').val();
                                }
                          $.ajax({
                              type:"GET",
                              url: '/ajax/Add_Dest_Review/',
                              dataType: 'json',
                              data:{
                                     Item_id: hhhh,
                                     content: content,
                                     ratings:rating,
                                },
                            success: function (data) {
                                document.getElementById("label11").innerHTML = data.message.toString();
                                document.getElementById("reviewcount").innerHTML = data.totalreviews.toString();
                                $("#mytable").load( " #mytable" );
                                $("#mytable1").load( " #mytable1" );
                            },
                              failure: function(data) {
                                  alert('Got an error dude');
                              }

                          });
                        }
                        </script>
				</section>
				<!--//three-fourth content-->
				
				<!--sidebar-->
				<aside class="one-fourth right-sidebar">

					<!--Need Help Booking?-->
					<article class="widget">
						<h4>Need Help</h4>
						<p>Call our customer services team on the number below to speak to one of our advisors who will help you with all of your holiday needs.</p>
						<p class="number">1- 555 - 555 - 555</p>
					</article>
					<!--//Need Help Booking?-->
					
					<!--Why us?-->
					<article class="widget">
						<h4>Why us?</h4>
						<h5>Best Recommendation</h5>
						<p>Get the best suggestions, or get the best trip recommendation free of cost.</p>
						<h5>Best Platform</h5>
						<p>140+ travelling companies 3 million guest reviews</p>
						<h5>We’re Always Here</h5>
						<p>Call or email us, anytimeGet 24-hour support before, during, and after your trip</p>
					</article>
					<!--//Why us?-->
					
					
					
					
				</aside>
				<!--//sidebar-->
			</div>
			<!--//main content-->
		</div>
	</main>
	<!--//main-->


    <script>
        var map;
        function initMap() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function (position) {
                    var pos = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude

                    };
                    window.pos = pos;

                    var directionsService = new google.maps.DirectionsService;
                    var directionsDisplay = new google.maps.DirectionsRenderer;
                    map = new google.maps.Map(document.getElementById('map1'), {
                        zoom: 7,
                        center: { lat: pos.lat, lng: pos.lng }
                    });
                    directionsDisplay.setMap(map);
                    calculateAndDisplayRoute(directionsService, directionsDisplay);
                }, function () {

                    handleLocationError(true, infoWindow, map.getCenter());
                });
            } else {
                // Browser doesn't support Geolocation
                handleLocationError(false, infoWindow, map.getCenter());

            }


        }

        function calculateAndDisplayRoute(directionsService, directionsDisplay) {

            console.log("Testing : " + pos);

            directionsService.route({
                origin: new google.maps.LatLng(pos.lat, pos.lng),
                destination: '{{ p.Des_Name }}',
                travelMode: 'DRIVING',
                provideRouteAlternatives: true,

            }, function (response, status) {
                var leng=response.routes.length;
                console.log(leng)
                var gt=0;
                if(leng==1){
                        document.getElementById("dist1").innerHTML = response.routes[0].legs[0].distance.text
                        document.getElementById("time1").innerHTML = response.routes[0].legs[0].duration.text
                        document.getElementById("summery1").innerHTML = response.routes[0].summary
                        document.getElementById("start1").innerHTML = response.routes[0].legs[0].start_address
                        document.getElementById("end1").innerHTML = response.routes[0].legs[0].end_address
                }
                if(leng==2)
                {
                    var max=Math.min(response.routes[0].legs[0].duration.value, response.routes[1].legs[0].duration.value,);
                    if(response.routes[0].legs[0].duration.value==max) {
                        document.getElementById("dist1").innerHTML = response.routes[0].legs[0].distance.text
                        document.getElementById("time1").innerHTML = response.routes[0].legs[0].duration.text
                        document.getElementById("summery1").innerHTML = response.routes[0].summary
                        document.getElementById("start1").innerHTML = response.routes[0].legs[0].start_address
                        document.getElementById("end1").innerHTML = response.routes[0].legs[0].end_address

                        document.getElementById("dist2").innerHTML=response.routes[1].legs[0].distance.text
                        document.getElementById("time2").innerHTML=response.routes[1].legs[0].duration.text
                        document.getElementById("summery2").innerHTML=response.routes[1].summary
                        document.getElementById("start2").innerHTML=response.routes[1].legs[0].start_address
                        document.getElementById("end2").innerHTML=response.routes[1].legs[0].end_address
                    }
                    else {
                        document.getElementById("dist1").innerHTML = response.routes[1].legs[0].distance.text
                        document.getElementById("time1").innerHTML = response.routes[1].legs[0].duration.text
                        document.getElementById("summery1").innerHTML = response.routes[1].summary
                        document.getElementById("start1").innerHTML = response.routes[1].legs[0].start_address
                        document.getElementById("end1").innerHTML = response.routes[1].legs[0].end_address

                        document.getElementById("dist2").innerHTML = response.routes[0].legs[0].distance.text
                        document.getElementById("time2").innerHTML = response.routes[0].legs[0].duration.text
                        document.getElementById("summery2").innerHTML = response.routes[0].summary
                        document.getElementById("start2").innerHTML = response.routes[0].legs[0].start_address
                        document.getElementById("end2").innerHTML = response.routes[0].legs[0].end_address
                    }

                }
                else if(leng==3)
                {
                    var max=Math.min(response.routes[0].legs[0].duration.value, response.routes[1].legs[0].duration.value,
                        response.routes[2].legs[0].distance.value);
                    if(response.routes[0].legs[0].duration.value==max)
                    {
                        document.getElementById("dist1").innerHTML = response.routes[0].legs[0].distance.text
                        document.getElementById("time1").innerHTML = response.routes[0].legs[0].duration.text
                        document.getElementById("summery1").innerHTML = response.routes[0].summary
                        document.getElementById("start1").innerHTML = response.routes[0].legs[0].start_address
                        document.getElementById("end1").innerHTML = response.routes[0].legs[0].end_address

                        document.getElementById("dist2").innerHTML=response.routes[1].legs[0].distance.text
                        document.getElementById("time2").innerHTML=response.routes[1].legs[0].duration.text
                        document.getElementById("summery2").innerHTML=response.routes[1].summary
                        document.getElementById("start2").innerHTML=response.routes[1].legs[0].start_address
                        document.getElementById("end2").innerHTML=response.routes[1].legs[0].end_address

                        document.getElementById("dist3").innerHTML=response.routes[2].legs[0].distance.text
                        document.getElementById("time3").innerHTML=response.routes[2].legs[0].duration.text
                        document.getElementById("summery3").innerHTML=response.routes[2].summary
                        document.getElementById("start3").innerHTML=response.routes[2].legs[0].start_address
                        document.getElementById("end3").innerHTML=response.routes[2].legs[0].end_address
                       }
                    else if(response.routes[1].legs[0].duration.value==max){
                        document.getElementById("dist1").innerHTML = response.routes[1].legs[0].distance.text
                        document.getElementById("time1").innerHTML = response.routes[1].legs[0].duration.text
                        document.getElementById("summery1").innerHTML = response.routes[1].summary
                        document.getElementById("start1").innerHTML = response.routes[1].legs[0].start_address
                        document.getElementById("end1").innerHTML = response.routes[1].legs[0].end_address

                        document.getElementById("dist2").innerHTML=response.routes[0].legs[0].distance.text
                        document.getElementById("time2").innerHTML=response.routes[0].legs[0].duration.text
                        document.getElementById("summery2").innerHTML=response.routes[0].summary
                        document.getElementById("start2").innerHTML=response.routes[0].legs[0].start_address
                        document.getElementById("end2").innerHTML=response.routes[0].legs[0].end_address

                        document.getElementById("dist3").innerHTML=response.routes[2].legs[0].distance.text
                        document.getElementById("time3").innerHTML=response.routes[2].legs[0].duration.text
                        document.getElementById("summery3").innerHTML=response.routes[2].summary
                        document.getElementById("start3").innerHTML=response.routes[2].legs[0].start_address
                        document.getElementById("end3").innerHTML=response.routes[2].legs[0].end_address}
                    else
                    {
                       document.getElementById("dist1").innerHTML = response.routes[2].legs[0].distance.text
                        document.getElementById("time1").innerHTML = response.routes[2].legs[0].duration.text
                        document.getElementById("summery1").innerHTML = response.routes[2].summary
                        document.getElementById("start1").innerHTML = response.routes[2].legs[0].start_address
                        document.getElementById("end1").innerHTML = response.routes[2].legs[0].end_address

                        document.getElementById("dist2").innerHTML=response.routes[1].legs[0].distance.text
                        document.getElementById("time2").innerHTML=response.routes[1].legs[0].duration.text
                        document.getElementById("summery2").innerHTML=response.routes[1].summary
                        document.getElementById("start2").innerHTML=response.routes[1].legs[0].start_address
                        document.getElementById("end2").innerHTML=response.routes[1].legs[0].end_address

                        document.getElementById("dist3").innerHTML=response.routes[0].legs[0].distance.text
                        document.getElementById("time3").innerHTML=response.routes[0].legs[0].duration.text
                        document.getElementById("summery3").innerHTML=response.routes[0].summary
                        document.getElementById("start3").innerHTML=response.routes[0].legs[0].start_address
                        document.getElementById("end3").innerHTML=response.routes[0].legs[0].end_address
                    }

                }


                console.log(response.routes)
                console.log(response)
                if (status == google.maps.DirectionsStatus.OK) {

                    var polycolour = "";
                    var Opacity = 0;
                    //var PolyLine = '';
                    for (var i = 0, len = response.routes.length; i < len; i++) {
                        if (i == 0) {
                            polycolour = "Blue";
                            Opacity = 5;
                        }
                        else {
                            polycolour = "grey";
                            Opacity = 5;
                        }
                        directionsDisplay = new google.maps.DirectionsRenderer({
                            zoom:7,
                            map: map,
                            directions: response,
                            routeIndex: i,
                            draggable: true,
                            polylineOptions: {
                                strokeColor: polycolour,
                                strokeWeight: Opacity
                            }
                        });
                        var trafficLayer = new google.maps.TrafficLayer();
                        trafficLayer.setMap(map);
                        map.setZoom(10);

                    }
                }
            });
        }
    </script>

    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCTw6qiEkOdQ41ooHj5LB4s_hIMHvr1xmI&callback=initMap">
        </script>


	{% endblock %}